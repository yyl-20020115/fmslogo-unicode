LOAD "testlib.lgo

TO LISTTOARRAYTEST.SMOKETEST

   ; EQUALP can't check an array for equality with another array
   ; so we have to use ARRAYP, COUNT, and ITEM, instead
   SIMPLEREPORTTEST [ ARRAYP LISTTOARRAY [a b c] ] LOCALETRUE
   SIMPLEREPORTTEST [ COUNT  LISTTOARRAY [a b c] ] 3
   SIMPLEREPORTTEST [ ITEM 1 LISTTOARRAY [a b c] ] "a
   SIMPLEREPORTTEST [ ITEM 2 LISTTOARRAY [a b c] ] "b
   SIMPLEREPORTTEST [ ITEM 3 LISTTOARRAY [a b c] ] "c

   ; empty list
   SIMPLEREPORTTEST [ ARRAYP LISTTOARRAY [] ] LOCALETRUE
   SIMPLEREPORTTEST [ COUNT  LISTTOARRAY [] ] 0

   ; test the origin of 0
   SIMPLEREPORTTEST [ ARRAYP (LISTTOARRAY [a b c] 0) ] LOCALETRUE
   SIMPLEREPORTTEST [ COUNT  (LISTTOARRAY [a b c] 0) ] 3
   SIMPLEREPORTTEST [ ITEM 0 (LISTTOARRAY [a b c] 0) ] "a
   SIMPLEREPORTTEST [ ITEM 1 (LISTTOARRAY [a b c] 0) ] "b
   SIMPLEREPORTTEST [ ITEM 2 (LISTTOARRAY [a b c] 0) ] "c

   ; test a negative origin
   SIMPLEREPORTTEST [ ARRAYP  (LISTTOARRAY [a b c] -5) ] LOCALETRUE
   SIMPLEREPORTTEST [ COUNT   (LISTTOARRAY [a b c] -5) ] 3
   SIMPLEREPORTTEST [ ITEM -5 (LISTTOARRAY [a b c] -5) ] "a
   SIMPLEREPORTTEST [ ITEM -4 (LISTTOARRAY [a b c] -5) ] "b
   SIMPLEREPORTTEST [ ITEM -3 (LISTTOARRAY [a b c] -5) ] "c

END

TO LISTTOARRAYTEST.BADINPUT

   RUNNOTENOUGHINPUTSTEST [(LISTTOARRAY)]
   RUNTOOMANYINPUTSTEST   [(LISTTOARRAY [1 2 3] 1 "toomany)]

   ; bad input with a list
   RUNDOESNTLIKEINPUTTEST [ LISTTOARRAY {a b c} ]
   RUNDOESNTLIKEINPUTTEST [ LISTTOARRAY "abc    ]
   RUNDOESNTLIKEINPUTTEST [ LISTTOARRAY 123     ]

   ; bad origin 
   RUNDOESNTLIKEINPUTTEST [ (LISTTOARRAY [1 2 3] 10.5    ) ]
   RUNDOESNTLIKEINPUTTEST [ (LISTTOARRAY [1 2 3] "ten    ) ]
   RUNDOESNTLIKEINPUTTEST [ (LISTTOARRAY [1 2 3] []      ) ]
   RUNDOESNTLIKEINPUTTEST [ (LISTTOARRAY [1 2 3] [1 2 3] ) ]
   RUNDOESNTLIKEINPUTTEST [ (LISTTOARRAY [1 2 3] {1 2 3} ) ]

END

TO LISTTOARRAYTEST

   LISTTOARRAYTEST.SMOKETEST
   LISTTOARRAYTEST.BADINPUT

END

