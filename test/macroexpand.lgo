LOAD "testlib.lgo

.MACRO MACROEXPANDTEST.OUTPUTNOTHING
  OUTPUT []
END

.MACRO MACROEXPANDTEST.MACROFORWARD :distance
  OUTPUT (LIST "FORWARD :distance)
END

TO MACROEXPANDTEST.BADINPUT

   ; Standard bad input tests
   RUNBADINPUTTEST  [ MACROEXPAND "badinput ]
   RUNBADINPUTTEST  [ MACROEXPAND 123       ]
   RUNBADINPUTTEST  [ MACROEXPAND []        ]
   RUNBADINPUTTEST  [ MACROEXPAND {abc}     ]

   ; FORWARD is not a macro
   RUNBADINPUTTEST  [ MACROEXPAND "FORWARD  ]

   RUNNOTENOUGHINPUTSTEST [(MACROEXPAND)]
   RUNTOOMANYINPUTSTEST   [(MACROEXPAND "MACROEXPANDTEST.OUTPUTNOTHING "toomany)]

END

TO MACROEXPANDTEST.SMOKETEST
    SIMPLEREPORTTEST [ MACROEXPAND [ MACROEXPANDTEST.OUTPUTNOTHING   ] ] []
    SIMPLEREPORTTEST [ MACROEXPAND [ MACROEXPANDTEST.MACROFORWARD 10 ] ] (LIST "FORWARD 10)
END

TO MACROEXPANDTEST

  MACROEXPANDTEST.SMOKETEST
  MACROEXPANDTEST.BADINPUT

END

