LOAD "testlib.lgo

TO ASCIITEST

  SIMPLEREPORTTEST [ ASCII "a   ] 97
  SIMPLEREPORTTEST [ ASCII "A   ] 65
  SIMPLEREPORTTEST [ ASCII 1    ] 49
  SIMPLEREPORTTEST [ ASCII "|(| ] 40

  RUNNOTENOUGHINPUTSTEST [(ASCII)]
  RUNTOOMANYINPUTSTEST   [(ASCII "a "b)]
  RUNDOESNTLIKEINPUTTEST [ASCII [a]]
  RUNDOESNTLIKEINPUTTEST [ASCII {a}]
  RUNDOESNTLIKEINPUTTEST [ASCII "ab]
  RUNDOESNTLIKEINPUTTEST [ASCII 1.2]

END

TO RAWASCIITEST

  SIMPLEREPORTTEST [ RAWASCII "a   ] 97
  SIMPLEREPORTTEST [ RAWASCII "A   ] 65
  SIMPLEREPORTTEST [ RAWASCII 1    ] 49

  ; Regression test for bug #16
  SIMPLEREPORTTEST [ RAWASCII CHAR 0   ] 0
  SIMPLEREPORTTEST [ RAWASCII CHAR 5   ] 5
  SIMPLEREPORTTEST [ RAWASCII CHAR 192 ] 192

  RUNNOTENOUGHINPUTSTEST [(RAWASCII)]
  RUNTOOMANYINPUTSTEST   [(RAWASCII "a "b)]
  RUNDOESNTLIKEINPUTTEST [RAWASCII [a]]
  RUNDOESNTLIKEINPUTTEST [RAWASCII {a}]
  RUNDOESNTLIKEINPUTTEST [RAWASCII "ab]
  RUNDOESNTLIKEINPUTTEST [RAWASCII 1.2]

END

TO WORDPROCTEST

  SIMPLEREPORTTEST [ WORD "o "k         ] "ok
  SIMPLEREPORTTEST [ WORD "4 "2         ] 42
  SIMPLEREPORTTEST [ (WORD)             ] "||
  SIMPLEREPORTTEST [ (WORD "o)          ] "o
  SIMPLEREPORTTEST [ (WORD "o "k "ay)   ] "okay
  SIMPLEREPORTTEST [ (WORD "|| "||)     ] "||
  SIMPLEREPORTTEST [ (WORD "|| "a  "||) ] "a

  RUNDOESNTLIKEINPUTTEST [WORD [] "a]
  RUNDOESNTLIKEINPUTTEST [WORD "a []]
  RUNDOESNTLIKEINPUTTEST [WORD "a {}]
  RUNDOESNTLIKEINPUTTEST [WORD {} "a]
END

TO CHARTEST
  ; NOTE: The tests for CHAR were written to test nonnegative_int_arg()

  ; Test that CHAR 0 is a valid input.
  ; We cannot test the output because there is no way to generate an
  ; equivalent return value without using CHAR.
  IGNORE CHAR 0
  
  SIMPLEREPORTTEST [CHAR 65 ]        "A 
  SIMPLEREPORTTEST [CHAR (256+65) ]  "A ; CHAR wraps modulo 256
  SIMPLEREPORTTEST [CHAR 65.0 ]      "A ; converts FLOAT to INT

  ; The highest value CHAR can convert is MAXINT
  SIMPLEREPORTTEST [CHAR 2147483647   ] "ÿ
  SIMPLEREPORTTEST [CHAR 2147483647.0 ] "ÿ

  ; bad input
  RUNDOESNTLIKEINPUTTEST [CHAR  "zero       ]
  RUNDOESNTLIKEINPUTTEST [CHAR  []          ]
  RUNDOESNTLIKEINPUTTEST [CHAR  [1]         ]
  RUNDOESNTLIKEINPUTTEST [CHAR  {1}         ]
  RUNDOESNTLIKEINPUTTEST [CHAR  0.5         ]
  RUNDOESNTLIKEINPUTTEST [CHAR -0.5         ]
  RUNDOESNTLIKEINPUTTEST [CHAR 2147483648   ]
  RUNDOESNTLIKEINPUTTEST [CHAR 2147483647.1 ]
END

TO WORDTEST
  WORDPROCTEST
  ASCIITEST
  RAWASCIITEST
  CHARTEST
END
