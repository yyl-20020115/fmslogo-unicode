LOAD "testlib.lgo

TO MACHINETEST.SMOKETEST

   LOCALMAKE "machine MACHINE

   FAILIFNOTTRUE    [LISTP MACHINE]
   SIMPLEREPORTTEST [COUNT MACHINE] 15

   ; Santity test each of the members of the list returned by MACHINE
   SIMPLEREPORTTEST [ITEM 1 MACHINE] 1             ; is windows
   SIMPLEREPORTTEST [ITEM 2 MACHINE] 32            ; word size
   FAILIFNOTTRUE    [LESSP ITEM 3 MACHINE 20000]   ; screen width
   FAILIFNOTTRUE    [LESSP ITEM 4 MACHINE 20000]   ; screen height
   SIMPLEREPORTTEST [ITEM 5 MACHINE] 0             ; is paletted
   FAILIFNOTTRUE    [LESSP ITEM 6 MACHINE 20]      ; windows major version
   FAILIFNOTTRUE    [LESSP ITEM 7 MACHINE 10]      ; windows minor version
   FAILIFNOTTRUE    [LESSP ITEM 8 MACHINE 20000]   ; working area width
   FAILIFNOTTRUE    [LESSP ITEM 9 MACHINE 20000]   ; working area height
   FAILIFNOTTRUE    [LESSEQUALP ITEM 10 MACHINE ITEM 8 MACHINE] ; desktop width
   FAILIFNOTTRUE    [LESSEQUALP ITEM 11 MACHINE ITEM 8 MACHINE] ; desktop height
   FAILIFNOTTRUE    [LESSP ITEM 12 MACHINE 20000]   ; main frame width
   FAILIFNOTTRUE    [LESSP ITEM 13 MACHINE 20000]   ; main frame height
END

TO MACHINETEST.BADINPUT
   RUNTOOMANYINPUTSTEST   [(MACHINE 0)]
END

TO MACHINETEST

   MACHINETEST.SMOKETEST
   MACHINETEST.BADINPUT

END
