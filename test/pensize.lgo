LOAD "testlib.lgo

TO PENSIZETEST.SETGETTEST :size

   ; sets and gets the pen size
   TRACEINSTRUCTION (LIST "SETPENSIZE :size)
   SIMPLEREPORTTEST [PENSIZE] :getsize
END


TO PENSIZETEST.SMOKETEST

   ; backup the current pensize
   LOCALMAKE "previous.pen.size PENSIZE

   TRACEINSTRUCTION [SETPENSIZE [10 10]]
   SIMPLEREPORTTEST [PENSIZE]   [10 10]

   TRACEINSTRUCTION [SETPENSIZE [1 1]]
   SIMPLEREPORTTEST [PENSIZE]   [1 1]

   TRACEINSTRUCTION [SETPENSIZE [0 0]]
   SIMPLEREPORTTEST [PENSIZE]   [0 0]

   ; floating point values get truncated
   TRACEINSTRUCTION [SETPENSIZE [1.9 1.9]]
   SIMPLEREPORTTEST [PENSIZE]   [1   1  ]

   ; PENSIZE accepts just the width as an input
   TRACEINSTRUCTION [SETPENSIZE 5]
   SIMPLEREPORTTEST [PENSIZE]   [5 5]

   ; restore the previous pen size
   SETPENSIZE :previous.pen.size

END

TO PENSIZETEST.BADINPUT

   ; bad number of inputs
   RUNTOOMANYINPUTSTEST [(PENSIZE "toomany)]

   ; backup the current pensize
   LOCALMAKE "previous.pen.size PENSIZE

   ; set the pen size to a known value so we can 
   ; verify that bad input doesn't change it.
   TRACEINSTRUCTION [ SETPENSIZE [11 11] ]

   RUNNOTENOUGHINPUTSTEST [(SETPENSIZE)]
   RUNTOOMANYINPUTSTEST   [(SETPENSIZE [5 5] "toomany)]

   ; bad input
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE -1      ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE 5.5     ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE 1e20    ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE "5x5    ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE {5 5}   ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [5]     ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [5 5 5] ]

   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [-1    5  ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [five  5  ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [[5]   5  ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [{5}   5  ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [1e20  5  ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [ 5   -1  ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [ 5   five] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [ 5   [5] ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [ 5   {5} ] ]
   RUNDOESNTLIKEINPUTTEST [ SETPENSIZE [ 5  1e20 ] ]

   ; make sure that the pen size didn't change
   SIMPLEREPORTTEST [PENSIZE] [11 11]

   ; restore the previous pen size
   SETPENSIZE :previous.pen.size

END


TO PENSIZETEST

   PENSIZETEST.SMOKETEST

   PENSIZETEST.BADINPUT

END
