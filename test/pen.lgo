LOAD "testlib.lgo


TO PENUPDOWNTEST
   LOCALMAKE "penwasdown PENDOWNP

   PENDOWN
   FAILIFNOTTRUE    [PENDOWNP]
   FAILIFNOTTRUE    [PENDOWN?]
   SIMPLEREPORTTEST [ITEM 1 PEN] "pendown

   PENUP
   FAILIFNOTFALSE   [PENDOWN?]
   SIMPLEREPORTTEST [ITEM 1 PEN] "penup

   RUNTOOMANYINPUTSTEST [(PENDOWN  "toomany)]
   RUNTOOMANYINPUTSTEST [(PENUP    "toomany)]
   RUNTOOMANYINPUTSTEST [(PENDOWN? "toomany)]

   ; undo side-effects
   IFELSE :penwasdown [ PENDOWN ] [ PENDUP ]
END

TO PENMODETEST

   LOCALMAKE "oldpenmode PENMODE
   LOCALMAKE "penwasdown PENDOWNP

   ; setting a new mode always puts the pen down

   PENUP
   PENPAINT
   SIMPLEREPORTTEST [PENMODE]    "paint
   SIMPLEREPORTTEST [ITEM 2 PEN] "paint
   FAILIFNOTTRUE    [PENDOWN?]

   PENUP
   PENERASE
   SIMPLEREPORTTEST [PENMODE]    "erase
   SIMPLEREPORTTEST [ITEM 2 PEN] "erase
   FAILIFNOTTRUE    [PENDOWN?]

   PENUP
   PENREVERSE
   SIMPLEREPORTTEST [PENMODE]    "reverse
   SIMPLEREPORTTEST [ITEM 2 PEN] "reverse
   FAILIFNOTTRUE    [PENDOWN?]

   PENUP
   PPT
   SIMPLEREPORTTEST [PENMODE]    "paint
   SIMPLEREPORTTEST [ITEM 2 PEN] "paint
   FAILIFNOTTRUE    [PENDOWN?]

   PENUP
   PE
   SIMPLEREPORTTEST [PENMODE]    "erase
   SIMPLEREPORTTEST [ITEM 2 PEN] "erase
   FAILIFNOTTRUE    [PENDOWN?]

   PENUP
   PX
   SIMPLEREPORTTEST [PENMODE]    "reverse
   SIMPLEREPORTTEST [ITEM 2 PEN] "reverse
   FAILIFNOTTRUE    [PENDOWN?]

   ; undo side-effects
   IFELSE :penwasdown [ PENDOWN ] [ PENDUP ]
   RUN    (list word "pen :oldpenmode)
END


TO PENTEST
  PENUPDOWNTEST
  PENMODETEST
END
