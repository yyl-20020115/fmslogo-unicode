LOAD "testlib.lgo
LOAD "uiautomationlib.lgo

TO DIALOGFILEOPEN.SMOKETEST

   UIAUTOMATION.INITIALIZE

   CATCH "ERROR [

     ; press OK
     UIAUTOMATION.POSTBUTTONPUSHTOWINDOW [Open] "&Open
     FAILIFNOTTRUE [ SUBSTRINGP "src\\test\\dialogfile.lgo DIALOGFILEOPEN "dialogfile.lgo ]

     ; lists are accepted as text
     UIAUTOMATION.POSTBUTTONPUSHTOWINDOW [Open] "&Open
     FAILIFNOTTRUE [ SUBSTRINGP "src\\test\\dialogfile.lgo DIALOGFILEOPEN [dialogfile.lgo] ]

     ; press Cancel
     UIAUTOMATION.POSTBUTTONPUSHTOWINDOW [Open] "Cancel
     SIMPLEREPORTTEST [ DIALOGFILEOPEN "*.lgo ] []
   ]

   IGNORE FAILIFERROR "DIALOGFILEOPEN.SMOKETEST

   UIAUTOMATION.UNINITIALIZE

END

TO DIALOGFILEOPEN.BADINPUT
   RUNNOTENOUGHINPUTSTEST [ IGNORE (DIALOGFILEOPEN) ]
   RUNTOOMANYINPUTSTEST   [ IGNORE (DIALOGFILEOPEN "dialogfile.lgo "toomany) ]
END

TO DIALOGFILESAVE.SMOKETEST

   UIAUTOMATION.INITIALIZE

   CATCH "ERROR [

     ; Press Save
     UIAUTOMATION.POSTBUTTONPUSHTOWINDOW [Save As] "&Save
     FAILIFNOTTRUE [ SUBSTRINGP "src\\test\\someunknownfile.txt DIALOGFILESAVE "someunknownfile.txt ]

     ; lists are converted to file names.
     UIAUTOMATION.POSTBUTTONPUSHTOWINDOW [Save As] "&Save
     FAILIFNOTTRUE [ SUBSTRINGP "|src\\test\\1 2 3| DIALOGFILESAVE [1 2 3] ]

     ; press Cancel
     UIAUTOMATION.POSTBUTTONPUSHTOWINDOW [Save As] "Cancel
     SIMPLEREPORTTEST [ DIALOGFILESAVE "*.lgo ] []
   ]

   IGNORE FAILIFERROR "DIALOGFILESAVE.SMOKETEST

   UIAUTOMATION.UNINITIALIZE

END

TO DIALOGFILESAVE.BADINPUT
   RUNNOTENOUGHINPUTSTEST [ IGNORE (DIALOGFILESAVE) ]
   RUNTOOMANYINPUTSTEST   [ IGNORE (DIALOGFILESAVE "dialogfile.lgo "toomany) ]
END

TO DIALOGFILETEST
  DIALOGFILEOPEN.SMOKETEST
  DIALOGFILEOPEN.BADINPUT

  DIALOGFILESAVE.SMOKETEST
  DIALOGFILEOPEN.BADINPUT
END
