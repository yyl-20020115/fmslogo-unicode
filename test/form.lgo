LOAD "testlib.lgo

TO FORMTEST.BADINPUT

  ; bad input tests
  RUNDOESNTLIKEINPUTTEST [FORM "string 10   10]
  RUNDOESNTLIKEINPUTTEST [FORM [123.1] 10   10]
  RUNDOESNTLIKEINPUTTEST [FORM {123.1} 10   10]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   -1   10]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   12.3 10]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   {10} 10]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   [10] 10]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1  "ten  10]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   10   12.3]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   10   [1]]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   10   {1}]
  RUNDOESNTLIKEINPUTTEST [FORM 123.1   10  "ten]

  RUNNOTENOUGHINPUTSTEST [(FORM)]
  RUNNOTENOUGHINPUTSTEST [(FORM 123.1)]
  RUNNOTENOUGHINPUTSTEST [(FORM 123.1 10)]
  RUNTOOMANYINPUTSTEST   [(FORM 123.1 10 10 10)]


END

TO FORMTEST.BUG4

  IGNORE FORM 123.1 10000 10
  REPORTTESTPASSED (sentence "|'FORM 123.1 10000 10' did not crash|)

  IGNORE FORM 123.1 10 1000000
  REPORTTESTPASSED (sentence "|'FORM 123.1 10 10000' did not crash|)

  ; regression test for Bug #4
  RUNBADINPUTTEST [FORM -1 -1 "%s%s]
  REPORTTESTPASSED (sentence "|'FORM -1 -1 "%s%s' did not crash|)

END


TO FORMTEST.SMOKETEST

  ; extend the number to fill all 10 slots
  SIMPLEREPORTTEST [FORM 123.456 10 10] "123.4560000000

  ; test when the width is smaller than precision
  SIMPLEREPORTTEST [FORM 123.456 0 10] "123.4560000000
  SIMPLEREPORTTEST [FORM 123.456 1 10] "123.4560000000

  ; test prepending spaces to fill width
  SIMPLEREPORTTEST [FORM 123.456 10 1] "|     123.5|
  SIMPLEREPORTTEST [FORM 123.456 10 0] "|       123|
  SIMPLEREPORTTEST [FORM 123.567 10 0] "|       124|

END

TO FORMTEST

  FORMTEST.SMOKETEST
  FORMTEST.BADINPUT
  FORMTEST.BUG4
END
