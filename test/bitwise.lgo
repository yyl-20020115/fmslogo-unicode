LOAD "testlib.lgo

TO BITANDTEST.SMOKETEST

  SIMPLEREPORTTEST [(BITAND)]      -1

  SIMPLEREPORTTEST [(BITAND 123)]   123
  SIMPLEREPORTTEST [(BITAND -123)] -123

  SIMPLEREPORTTEST [ BITAND 5    2   ]   0
  SIMPLEREPORTTEST [ BITAND 5    1   ]   1
  SIMPLEREPORTTEST [ BITAND 0   -1   ]   0
  SIMPLEREPORTTEST [ BITAND 5   -1   ]   5
  SIMPLEREPORTTEST [ BITAND 5.0  1.0 ]   1

  SIMPLEREPORTTEST [(BITAND 6 2 10)]     2

END

TO BITANDTEST.BADINPUT

  ; first input is bad
  RUNDOESNTLIKEINPUTTEST [(BITAND "word)]
  RUNDOESNTLIKEINPUTTEST [(BITAND [123])]
  RUNDOESNTLIKEINPUTTEST [(BITAND {123})]
  RUNDOESNTLIKEINPUTTEST [(BITAND 12.30)]

  ; second input is bad
  RUNDOESNTLIKEINPUTTEST [(BITAND 1 "word)]
  RUNDOESNTLIKEINPUTTEST [(BITAND 1 [123])]
  RUNDOESNTLIKEINPUTTEST [(BITAND 1 {123})]
  RUNDOESNTLIKEINPUTTEST [(BITAND 1 12.30)]

  ; Confirm that the errors are really recoverable
  ; In this case, all initial inputs are bad, as
  ; are the first replacement value which ERRACT outputs
  ; for each of the inputs.
  RUNRECOVERABLEERRORTEST ~
    [(BITAND "all "bad "input)] ~
    [1.2 11 1.4 5 1.2 7] ~
    [1]

END

TO BITORTEST.SMOKETEST

  SIMPLEREPORTTEST [(BITOR)]          0

  SIMPLEREPORTTEST [(BITOR  123   )]  123
  SIMPLEREPORTTEST [(BITOR -123   )] -123

  SIMPLEREPORTTEST [BITOR 5    2  ]  7
  SIMPLEREPORTTEST [BITOR 5    1  ]  5
  SIMPLEREPORTTEST [BITOR 0    0  ]  0
  SIMPLEREPORTTEST [BITOR 5   -1  ] -1
  SIMPLEREPORTTEST [BITOR 5.0  2.0]  7

  SIMPLEREPORTTEST [(BITOR 6 2 10)]  14

END

TO BITORTEST.BADINPUT

  ; first input is bad
  RUNDOESNTLIKEINPUTTEST [(BITOR "word)]
  RUNDOESNTLIKEINPUTTEST [(BITOR [123])]
  RUNDOESNTLIKEINPUTTEST [(BITOR {123})]
  RUNDOESNTLIKEINPUTTEST [(BITOR 12.30)]

  ; second input is bad
  RUNDOESNTLIKEINPUTTEST [(BITOR 1 "word)]
  RUNDOESNTLIKEINPUTTEST [(BITOR 1 [123])]
  RUNDOESNTLIKEINPUTTEST [(BITOR 1 {123})]
  RUNDOESNTLIKEINPUTTEST [(BITOR 1 12.30)]

  ; Confirm that the errors are really recoverable
  ; In this case, all initial inputs are bad, as
  ; are the first replacement value which ERRACT outputs
  ; for each of the inputs.
  RUNRECOVERABLEERRORTEST ~
    [(BITOR "all "bad "input)] ~
    [1.2 1 1.4 2 1.2 4] ~
    [7]
END


TO BITXORTEST.SMOKETEST

  SIMPLEREPORTTEST [(BITXOR)]           0

  SIMPLEREPORTTEST [(BITXOR  123   )]  123
  SIMPLEREPORTTEST [(BITXOR -123   )] -123

  SIMPLEREPORTTEST [BITXOR 5    2   ]  7
  SIMPLEREPORTTEST [BITXOR 5    1   ]  4
  SIMPLEREPORTTEST [BITXOR 0    0   ]  0
  SIMPLEREPORTTEST [BITXOR 5   -1   ] -6
  SIMPLEREPORTTEST [BITXOR 5    5   ]  0
  SIMPLEREPORTTEST [BITXOR 5.0  1.0 ]  4

  SIMPLEREPORTTEST [(BITXOR 6  2 10)]  14

END

TO BITXORTEST.BADINPUT

  ; first input is bad
  RUNDOESNTLIKEINPUTTEST [(BITXOR "word)]
  RUNDOESNTLIKEINPUTTEST [(BITXOR [123])]
  RUNDOESNTLIKEINPUTTEST [(BITXOR {123})]
  RUNDOESNTLIKEINPUTTEST [(BITXOR 12.30)]

  ; second input is bad
  RUNDOESNTLIKEINPUTTEST [(BITXOR 1 "word)]
  RUNDOESNTLIKEINPUTTEST [(BITXOR 1 [123])]
  RUNDOESNTLIKEINPUTTEST [(BITXOR 1 {123})]
  RUNDOESNTLIKEINPUTTEST [(BITXOR 1 12.30)]

  ; Confirm that the errors are really recoverable
  ; In this case, all initial inputs are bad, as
  ; are the first replacement value which ERRACT outputs
  ; for each of the inputs.
  RUNRECOVERABLEERRORTEST ~
    [(BITXOR "all "bad "input)] ~
    [1.2 6 1.4 2 1.2 10] ~
    [14]
END

TO BITNOTTEST.SMOKETEST

  SIMPLEREPORTTEST [BITNOT  123  ] -124
  SIMPLEREPORTTEST [BITNOT -124  ]  123
  SIMPLEREPORTTEST [BITNOT    0  ] -1
  SIMPLEREPORTTEST [BITNOT 12.00 ] -13

END

TO BITNOTTEST.BADINPUT

  RUNNOTENOUGHINPUTSTEST [(BITNOT)]
  RUNTOOMANYINPUTSTEST   [(BITNOT 123 456)]

  RUNDOESNTLIKEINPUTTEST [BITNOT "word]
  RUNDOESNTLIKEINPUTTEST [BITNOT [123]]
  RUNDOESNTLIKEINPUTTEST [BITNOT {123}]
  RUNDOESNTLIKEINPUTTEST [BITNOT 12.30]

  ; Confirm that the errors are really recoverable.
  RUNRECOVERABLEERRORTEST [BITNOT "bad] [{456} 123] [-124]
END


TO LSHIFTTEST.SMOKETEST

  SIMPLEREPORTTEST [LSHIFT   5    2    ]          20
  SIMPLEREPORTTEST [LSHIFT  20   -2    ]           5
  SIMPLEREPORTTEST [LSHIFT -20   -1    ]  2147483638
  SIMPLEREPORTTEST [LSHIFT   5    0    ]           5
  SIMPLEREPORTTEST [LSHIFT   0    5    ]           0
  SIMPLEREPORTTEST [LSHIFT   5.0  2.00 ]          20

END

TO LSHIFTTEST.BADINPUT

  RUNNOTENOUGHINPUTSTEST [(LSHIFT 5)]
  RUNTOOMANYINPUTSTEST   [(LSHIFT 5 0 "toomany)]

  ; bad first input
  RUNDOESNTLIKEINPUTTEST [LSHIFT "word 0]
  RUNDOESNTLIKEINPUTTEST [LSHIFT [123] 0]
  RUNDOESNTLIKEINPUTTEST [LSHIFT {123} 0]
  RUNDOESNTLIKEINPUTTEST [LSHIFT 12.30 0]

  ; bad second input
  RUNDOESNTLIKEINPUTTEST [LSHIFT 5 "word]
  RUNDOESNTLIKEINPUTTEST [LSHIFT 5 [123]]
  RUNDOESNTLIKEINPUTTEST [LSHIFT 5 {123}]
  RUNDOESNTLIKEINPUTTEST [LSHIFT 5 12.30]

  ; Confirm that the errors are really recoverable.
  ; In this case, both initial inputs are bad, as
  ; are the first values output by ERRACT as replacements.
  RUNRECOVERABLEERRORTEST [LSHIFT "bad "input] [bad 5 bad 2] [20]

END

TO ASHIFTTEST.SMOKETEST

  SIMPLEREPORTTEST [ASHIFT   5    2    ]  20
  SIMPLEREPORTTEST [ASHIFT  20   -2    ]   5
  SIMPLEREPORTTEST [ASHIFT -20   -1    ] -10
  SIMPLEREPORTTEST [ASHIFT   5    0    ]   5
  SIMPLEREPORTTEST [ASHIFT   0    5    ]   0
  SIMPLEREPORTTEST [ASHIFT   5.0  2.00 ]   20

END

TO ASHIFTTEST.BADINPUT

  RUNNOTENOUGHINPUTSTEST [(ASHIFT 5)]
  RUNTOOMANYINPUTSTEST   [(ASHIFT 5 0 "toomany)]

  ; bad first input
  RUNDOESNTLIKEINPUTTEST [ASHIFT "word 0]
  RUNDOESNTLIKEINPUTTEST [ASHIFT [123] 0]
  RUNDOESNTLIKEINPUTTEST [ASHIFT {123} 0]
  RUNDOESNTLIKEINPUTTEST [ASHIFT 12.30 0]

  ; bad second input
  RUNDOESNTLIKEINPUTTEST [ASHIFT 5 "word]
  RUNDOESNTLIKEINPUTTEST [ASHIFT 5 [123]]
  RUNDOESNTLIKEINPUTTEST [ASHIFT 5 {123}]
  RUNDOESNTLIKEINPUTTEST [ASHIFT 5 12.30]

  ; Confirm that the errors are really recoverable.
  ; In this case, both initial inputs are bad, as
  ; are the first values output by ERRACT as replacements.
  RUNRECOVERABLEERRORTEST [ASHIFT "bad "input] [bad 5 bad 2] [20]

END

TO BITWISETEST

  BITANDTEST.SMOKETEST
  BITANDTEST.BADINPUT

  BITORTEST.SMOKETEST
  BITORTEST.BADINPUT

  BITXORTEST.SMOKETEST
  BITXORTEST.BADINPUT

  BITNOTTEST.SMOKETEST
  BITNOTTEST.BADINPUT

  LSHIFTTEST.SMOKETEST
  LSHIFTTEST.BADINPUT

  ASHIFTTEST.SMOKETEST
  ASHIFTTEST.BADINPUT
END

